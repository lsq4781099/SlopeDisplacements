
clearvars,clc

% Chile
VERT = [-16.50  -75.00  -5.00   -16.50  -73.00  -94.94  -16.00  -73.00  -94.94  -16.00  -75.00  -5.00
-17.00  -74.00  -5.00   -17.00  -72.50  -72.45  -16.50  -72.50  -72.45  -16.50  -74.00  -5.00
-18.00  -73.00  -5.00   -18.00  -71.50  -72.45  -17.00  -71.50  -72.45  -17.00  -73.00  -5.00
-19.00  -72.00  -5.00   -19.00  -70.50  -72.45  -18.00  -70.50  -72.45  -18.00  -72.00  -5.00
-20.00  -71.50  -5.00   -20.00  -69.75  -83.69  -19.00  -69.75  -83.69  -19.00  -71.50  -5.00
-25.00  -71.25  -5.00   -25.00  -69.50  -83.67  -20.00  -69.50  -83.67  -20.00  -71.25  -5.00
-27.00  -71.50  -5.00   -27.00  -69.75  -79.35  -25.00  -69.75  -79.35  -25.00  -71.50  -5.00
-27.50  -71.75  -5.00   -27.50  -70.00  -74.52  -27.00  -70.00  -74.52  -27.00  -71.75  -5.00
-28.00  -72.00  -5.00   -28.00  -70.25  -73.18  -27.50  -70.25  -73.18  -27.50  -72.00  -5.00
-29.00  -72.25  -5.00   -29.00  -70.50  -71.01  -28.00  -70.50  -71.01  -28.00  -72.25  -5.00
-32.00  -72.50  -5.00   -32.00  -71.00  -63.13  -29.00  -71.00  -63.13  -29.00  -72.50  -5.00
-34.00  -72.75  -5.00   -34.00  -71.00  -82.92  -32.00  -71.00  -82.92  -32.00  -72.75  -5.00
-34.50  -73.00  -5.00   -34.50  -71.25  -88.41  -34.00  -71.25  -88.41  -34.00  -73.00  -5.00
-35.50  -73.50  -5.00   -35.50  -71.25  -115.51 -34.50  -71.25  -115.51 -34.50  -73.50  -5.00
-36.50  -74.00  -5.00   -36.50  -71.50  -128.77 -35.50  -71.50  -128.77 -35.50  -74.00  -5.00
-37.50  -74.50  -5.00   -37.50  -72.00  -128.76 -36.50  -72.00  -128.76 -36.50  -74.50  -5.00
-38.50  -74.75  -5.00   -38.50  -71.25  -178.25 -37.50  -71.25  -178.25 -37.50  -74.75  -5.00
-40.50  -75.00  -5.00   -40.50  -71.50  -178.23 -38.50  -71.50  -178.23 -38.50  -75.00  -5.00
-41.50  -75.25  -5.00   -41.50  -71.75  -178.22 -40.50  -71.75  -178.22 -40.50  -75.25  -5.00
-42.50  -75.50  -5.00   -42.50  -72.00  -178.21 -41.50  -72.00  -178.21 -41.50  -75.50  -5.00
-43.50  -75.75  -5.00   -43.50  -72.25  -178.20 -42.50  -72.25  -178.21 -42.50  -75.75  -5.00
-47.00  -76.00  -5.00   -47.00  -72.50  -178.16 -43.50  -72.50  -178.16 -43.50  -76.00  -5.00
-16.50  -73.00  -94.94  -16.50  -70.00  -229.85 -16.00  -70.00  -229.85 -16.00  -73.00  -94.94
-17.00  -72.50  -72.45  -17.00  -69.00  -229.84 -16.50  -69.00  -229.84 -16.50  -72.50  -72.45
-18.00  -71.50  -72.45  -18.00  -68.00  -229.83 -17.00  -68.00  -229.83 -17.00  -71.50  -72.45
-19.00  -70.50  -72.45  -19.00  -67.00  -229.83 -18.00  -67.00  -229.83 -18.00  -70.50  -72.45
-20.00  -69.75  -83.69  -20.00  -66.50  -229.82 -19.00  -66.50  -229.82 -19.00  -69.75  -83.69
-25.00  -69.50  -83.67  -25.00  -66.25  -229.77 -20.00  -66.25  -229.77 -20.00  -69.50  -83.67
-27.00  -69.75  -79.35  -27.00  -66.50  -217.42 -25.00  -66.50  -217.42 -25.00  -69.75  -79.35
-27.50  -70.00  -74.52  -27.50  -66.75  -203.62 -27.00  -66.75  -203.62 -27.00  -70.00  -74.52
-28.00  -70.25  -73.18  -28.00  -67.00  -199.79 -27.50  -67.00  -199.79 -27.50  -70.25  -73.18
-29.00  -70.50  -71.01  -29.00  -67.25  -193.59 -28.00  -67.25  -193.59 -28.00  -70.50  -71.01
-31.00  -71.00  -63.13  -31.00  -67.50  -198.78 -29.00  -67.50  -198.78 -29.00  -71.00  -63.13
-32.00  -71.00  -63.13  -32.00  -67.50  -198.77 -31.00  -67.50  -198.77 -31.00  -71.00  -63.13
-34.00  -71.00  -82.92  -34.00  -68.25  -205.37 -32.00  -68.25  -205.37 -32.00  -71.00  -82.92
-34.50  -71.25  -88.41  -34.50  -68.75  -207.57 -34.00  -68.75  -207.57 -34.00  -71.25  -88.41
-35.50  -71.25  -115.51 -35.50  -69.50  -201.46 -34.50  -69.50  -201.46 -34.50  -71.25  -115.51
-36.50  -71.50  -128.77 -36.50  -70.25  -190.65 -35.50  -70.25  -190.65 -35.50  -71.50  -128.77
-37.50  -72.00  -128.76 -37.50  -71.00  -178.26 -36.50  -71.00  -178.26 -36.50  -72.00  -128.76];
ind = 21;
vertices = reshape(VERT(ind,:),3,4)';

% Chile but dipping west
vertices(:,3) = vertices([2 1 4 3],3);

% Chile but in Northern HGemisphere
% vertices = vertices*diag([-1 1 1]);



% PEER Sources
% VERT=[38.00000 -122 0   38.00000 -122 -12    38.22500 -122 -12    38.22500 -122 0];
% vertices = reshape(VERT(1,:),3,4)';

% VERT=[38.00000 122 0   38.00000 122 -12    38.22500 122 -12    38.22500 122 0];
% vertices = reshape(VERT(1,:),3,4)';

% VERT=[-38.00000 122 0   -38.00000 122 -12    -38.22500 122 -12    -38.22500 122 0];
% vertices = reshape(VERT(1,:),3,4)';

x = vertices(:,1);
y = vertices(:,2);
z = vertices(:,3);
ellip = referenceEllipsoid('WGS84','km');
dip   = createFit2Dplane(vertices,ellip);
