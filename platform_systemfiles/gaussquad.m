function [x,c]=gaussquad(n,ab)
%GAUSSQUAD  Gaussian quadrature

switch  n
    case 1
        c=2;
        x=0;
    case 2
        c=[1.0000000000000000;1.0000000000000000];
        x=[-0.5773502691896250;0.5773502691896250];
    case 3
        c=[0.5555555555555550;0.8888888888888880;0.5555555555555550];
        x=[-0.7745966692414830;0.0000000000000000;0.7745966692414830];
    case 4
        c=[0.3478548451374530;0.6521451548625460;0.6521451548625460;0.3478548451374530];
        x=[-0.8611363115940520;-0.3399810435848560;0.3399810435848560;0.8611363115940520];
    case 5
        c=[0.2369268850561890;0.4786286704993660;0.5688888888888880;0.4786286704993660;0.2369268850561890];
        x=[-0.9061798459386640;-0.5384693101056830;0.0000000000000000;0.5384693101056830;0.9061798459386640];
    case 6
        c=[0.1713244923791700;0.3607615730481380;0.4679139345726910;0.4679139345726910;0.3607615730481380;0.1713244923791700];
        x=[-0.9324695142031520;-0.6612093864662640;-0.2386191860831960;0.2386191860831960;0.6612093864662640;0.9324695142031520];
    case 7
        c=[0.1294849661688690;0.2797053914892760;0.3818300505051180;0.4179591836734690;0.3818300505051180;0.2797053914892760;0.1294849661688690];
        x=[-0.9491079123427580;-0.7415311855993940;-0.4058451513773970;0.0000000000000000;0.4058451513773970;0.7415311855993940;0.9491079123427580];
    case 8
        c=[0.1012285362903760;0.2223810344533740;0.3137066458778870;0.3626837833783620;0.3626837833783620;0.3137066458778870;0.2223810344533740;0.1012285362903760];
        x=[-0.9602898564975360;-0.7966664774136260;-0.5255324099163290;-0.1834346424956490;0.1834346424956490;0.5255324099163290;0.7966664774136260;0.9602898564975360];
    case 9
        c=[0.0812743883615744;0.1806481606948570;0.2606106964029350;0.3123470770400020;0.3302393550012590;0.3123470770400020;0.2606106964029350;0.1806481606948570;0.0812743883615744];
        x=[-0.9681602395076260;-0.8360311073266350;-0.6133714327005900;-0.3242534234038080;0.0000000000000000;0.3242534234038080;0.6133714327005900;0.8360311073266350;0.9681602395076260];
    case 10
        c=[0.0666713443086881;0.1494513491505800;0.2190863625159820;0.2692667193099960;0.2955242247147520;0.2955242247147520;0.2692667193099960;0.2190863625159820;0.1494513491505800;0.0666713443086881];
        x=[-0.9739065285171710;-0.8650633666889840;-0.6794095682990240;-0.4333953941292470;-0.1488743389816310;0.1488743389816310;0.4333953941292470;0.6794095682990240;0.8650633666889840;0.9739065285171710];
    case 11
        c=[0.0556685671161737;0.1255803694649040;0.1862902109277340;0.2331937645919900;0.2628045445102460;0.2729250867779000;0.2628045445102460;0.2331937645919900;0.1862902109277340;0.1255803694649040;0.0556685671161737];
        x=[-0.9782286581460570;-0.8870625997680950;-0.7301520055740490;-0.5190961292068110;-0.2695431559523450;0.0000000000000000;0.2695431559523450;0.5190961292068110;0.7301520055740490;0.8870625997680950;0.9782286581460570];
    case 12
        c=[0.0471753363865118;0.1069393259953180;0.1600783285433460;0.2031674267230650;0.2334925365383540;0.2491470458134020;0.2491470458134020;0.2334925365383540;0.2031674267230650;0.1600783285433460;0.1069393259953180;0.0471753363865118];
        x=[-0.9815606342467190;-0.9041172563704740;-0.7699026741943040;-0.5873179542866170;-0.3678314989981800;-0.1252334085114680;0.1252334085114680;0.3678314989981800;0.5873179542866170;0.7699026741943040;0.9041172563704740;0.9815606342467190];
    case 13
        c=[0.0404840047653050;0.0921214998377594;0.1388735102197510;0.1781459807619630;0.2078160475368930;0.2262831802628850;0.2325515532308890;0.2262831802628790;0.2078160475369040;0.1781459807619460;0.1388735102197660;0.0921214998377515;0.0404840047653082];
        x=[-0.9841830547186000;-0.9175983992229670;-0.8015780907333100;-0.6423493394403490;-0.4484927510364410;-0.2304583159551350;0.0000000000000000;0.2304583159551350;0.4484927510364420;0.6423493394403500;0.8015780907333020;0.9175983992229740;0.9841830547185940];
    case 14
        c=[0.0351194603317439;0.0801580871596729;0.1215185706881660;0.1572031671578790;0.1855383974781790;0.2051984637211550;0.2152638534632070;0.2152638534631980;0.2051984637211550;0.1855383974781970;0.1572031671578500;0.1215185706881890;0.0801580871596557;0.0351194603317518];
        x=[-0.9862838086967530;-0.9284348836637200;-0.8272013150696360;-0.6872929048117410;-0.5152486363581420;-0.3191123689278920;-0.1080549487073430;0.1080549487073430;0.3191123689278910;0.5152486363581440;0.6872929048117470;0.8272013150696280;0.9284348836637260;0.9862838086967450];
    case 15
        c=[0.0307532419961654;0.0703660474879251;0.1071592204674100;0.1395706779259980;0.1662692058170900;0.1861610000154820;0.1984314853271840;0.2025782419254990;0.1984314853271600;0.1861610000155320;0.1662692058170180;0.1395706779260800;0.1071592204673310;0.0703660474879687;0.0307532419961584];
        x=[-0.9879925180204200;-0.9372733924007930;-0.8482065834104220;-0.7244177313601480;-0.5709721726085460;-0.3941513470775620;-0.2011940939974350;0.0000000000000000;0.2011940939974340;0.3941513470775610;0.5709721726085530;0.7244177313601300;0.8482065834104520;0.9372733924007470;0.9879925180204470];
    otherwise
        P=zeros(n+1,n+1);
        P([1,2],1)=1;
        for k=1:n-1
            P(k+2,1:k+2)=((2*k+1)*[P(k+1,1:k+1) 0]-k*[0 0 P(k,1:k)])/(k+1);
        end
        x=sort(roots(P(n+1,1:n+1)));
        
        A=zeros(n,n);
        for i=1:n
            A(i,:)=polyval(P(i,1:i),x)';
        end
        c=A\[2;zeros(n-1,1)];
end
% Scaling gauss points to fit interval [a,b]
a=ab(1);
b=ab(2);
x = a+(x+1)*(b-a)/2;
c = c*(b-a)/2;