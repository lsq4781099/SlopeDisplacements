function [rho] = SR_spectral_2019(T1, T2,param)

% ---- help for SR_spectral_2019 ---
% Candia et al. 2019
% RHO = SR_spectral_2019(T1,T2,M,mechanism)
%
% Developed by G.Candia, April 2019. Santiago.
% National Research Center for Integrated Natural Disaster Management
% CONICYT/FONDAP/15110017. FONDECYT N° 1170836 “SIBER-RISK: SImulation
% Based Earthquake Risk and Resilience of Interdependent Systems and NetworKs

T1(and(T1>=0,T1<0.01))=0.01;
T2(and(T2>=0,T2<0.01))=0.01;

T_min = min(T1, T2); 
T_max = max(T1, T2); 
switch param.mechanism
    case {'interface','grid'}
        V     = interfaceV();
    case 'intraslab'
        V     = intraslabV();
end
    
T      = [-1 0.01 0.02  0.05  0.075  0.1  0.15  0.2  0.25  0.3  0.4  0.5  0.6  0.75  1  1.5  2  2.5  3  4  5  6  7.5  10];
[X,Y] = meshgrid(T);
rho   = interp2(X,Y,V,T_min,T_max,'spline');
rho(T_min==T_max)=1;
rho   = min(rho,1);
rho   = max(rho,min(V(:)));

rho(and(T_min<0.01,T_min>0)) = nan;
rho(T_max>10)   = nan;

function V=interfaceV()
V=[1	0.8105	0.7596	0.6712	0.6384	0.649	0.6954	0.7584	0.8028	0.8227	0.8145	0.7915	0.7744	0.7722	0.7684	0.7692	0.7662	0.7699	0.7805	0.797	0.8084	0.8154	0.8269	0.8376
0.8105	1	0.942	0.8886	0.8673	0.8612	0.8628	0.8514	0.8201	0.7657	0.6795	0.6031	0.5543	0.5265	0.5024	0.5069	0.5138	0.528	0.5513	0.579	0.5975	0.6102	0.6319	0.6519
0.7596	0.942	1	0.9604	0.9388	0.9247	0.905	0.864	0.8077	0.7344	0.6247	0.5374	0.4835	0.4526	0.4256	0.4376	0.449	0.4652	0.4926	0.5228	0.5428	0.5558	0.5812	0.6034
0.6712	0.8886	0.9604	1	0.9654	0.9255	0.8706	0.8013	0.7287	0.6443	0.528	0.439	0.3873	0.3586	0.3337	0.3495	0.362	0.378	0.4045	0.4334	0.4504	0.4605	0.4847	0.5043
0.6384	0.8673	0.9388	0.9654	1	0.9505	0.8766	0.7868	0.7028	0.6129	0.4908	0.3991	0.347	0.3214	0.3016	0.3209	0.3332	0.3492	0.3766	0.4062	0.422	0.4303	0.4543	0.4732
0.649	0.8612	0.9247	0.9255	0.9505	1	0.9176	0.8186	0.7274	0.6322	0.5061	0.4105	0.3561	0.331	0.3137	0.3345	0.3468	0.364	0.3933	0.4267	0.4445	0.4539	0.4792	0.5015
0.6954	0.8628	0.905	0.8706	0.8766	0.9176	1	0.9014	0.8109	0.707	0.5728	0.4719	0.4134	0.3837	0.3626	0.3788	0.3923	0.4123	0.4435	0.4802	0.5015	0.5135	0.5389	0.5639
0.7584	0.8514	0.864	0.8013	0.7868	0.8186	0.9014	1	0.9174	0.8228	0.6938	0.5924	0.5309	0.4972	0.4676	0.4707	0.4787	0.4945	0.5216	0.5552	0.5769	0.5896	0.612	0.6348
0.8028	0.8201	0.8077	0.7287	0.7028	0.7274	0.8109	0.9174	1	0.9202	0.8094	0.7108	0.6453	0.6068	0.5712	0.5614	0.5643	0.5775	0.5999	0.6287	0.6478	0.6599	0.6774	0.6945
0.8227	0.7657	0.7344	0.6443	0.6129	0.6322	0.707	0.8228	0.9202	1	0.9009	0.811	0.7441	0.7035	0.6652	0.6436	0.6394	0.6469	0.6634	0.685	0.6995	0.7087	0.7223	0.7338
0.8145	0.6795	0.6247	0.528	0.4908	0.5061	0.5728	0.6938	0.8094	0.9009	1	0.9199	0.8582	0.8066	0.7533	0.7132	0.6962	0.6953	0.7041	0.7181	0.7274	0.7341	0.7451	0.7535
0.7915	0.6031	0.5374	0.439	0.3991	0.4105	0.4719	0.5924	0.7108	0.811	0.9199	1	0.9432	0.8842	0.8117	0.7496	0.7198	0.7106	0.7114	0.7177	0.7226	0.7284	0.739	0.7467
0.7744	0.5543	0.4835	0.3873	0.347	0.3561	0.4134	0.5309	0.6453	0.7441	0.8582	0.9432	1	0.9398	0.8601	0.7822	0.7426	0.7264	0.7205	0.7175	0.7179	0.7208	0.7274	0.7322
0.7722	0.5265	0.4526	0.3586	0.3214	0.331	0.3837	0.4972	0.6068	0.7035	0.8066	0.8842	0.9398	1	0.9233	0.8434	0.7994	0.7791	0.7653	0.7523	0.7456	0.7428	0.7412	0.7393
0.7684	0.5024	0.4256	0.3337	0.3016	0.3137	0.3626	0.4676	0.5712	0.6652	0.7533	0.8117	0.8601	0.9233	1	0.9211	0.875	0.8484	0.8267	0.8045	0.7901	0.7798	0.7693	0.7581
0.7692	0.5069	0.4376	0.3495	0.3209	0.3345	0.3788	0.4707	0.5614	0.6436	0.7132	0.7496	0.7822	0.8434	0.9211	1	0.9502	0.9187	0.8917	0.8642	0.8433	0.8258	0.8091	0.7895
0.7662	0.5138	0.449	0.362	0.3332	0.3468	0.3923	0.4787	0.5643	0.6394	0.6962	0.7198	0.7426	0.7994	0.875	0.9502	1	0.9668	0.938	0.9058	0.8795	0.8578	0.8361	0.8064
0.7699	0.528	0.4652	0.378	0.3492	0.364	0.4123	0.4945	5.78E-01	0.6469	0.6953	0.7106	0.7264	0.7791	0.8484	0.9187	0.9668	1	0.9712	0.9364	0.9061	0.8816	0.8581	0.8237
0.7805	0.5513	0.4926	0.4045	0.3766	0.3933	0.4435	0.5216	0.5999	0.6634	0.7041	0.7114	0.7205	0.7653	0.8267	0.8917	0.938	0.9712	1	0.9657	0.9355	0.909	0.8843	0.8498
0.797	0.579	0.5228	0.4334	0.4062	0.4267	0.4802	0.5552	0.6287	0.685	0.7181	0.7177	0.7175	0.7523	0.8045	0.8642	0.9058	0.9364	0.9657	1	0.9714	0.9461	0.921	0.888
0.8084	0.5975	0.5428	0.4504	0.422	0.4445	0.5015	0.5769	0.6478	0.6995	0.7274	0.7226	0.7179	0.7456	0.7901	0.8433	0.8795	0.9061	0.9355	0.9714	1	0.9765	0.9518	0.92
0.8154	0.6102	0.5558	0.4605	0.4303	0.4539	0.5135	0.5896	0.6599	0.7087	0.7341	0.7284	0.7208	0.7428	0.7798	0.8258	0.8578	0.8816	0.909	0.9461	0.9765	1	0.9754	0.9462
0.8269	0.6319	0.5812	0.4847	0.4543	0.4792	0.5389	0.612	0.6774	0.7223	0.7451	0.739	0.7274	0.7412	0.7693	0.8091	0.8361	0.8581	0.8843	0.921	0.9518	0.9754	1	0.9726
0.8376	0.6519	0.6034	0.5043	0.4732	0.5015	0.5639	0.6348	0.6945	0.7338	0.7535	0.7467	0.7322	0.7393	0.7581	0.7895	0.8064	0.8237	0.8498	0.888	0.92	0.9462	0.9726	1];

function V=intraslabV()

V=[1	0.8298	0.7364	0.5682	0.5293	0.591	0.7409	0.8371	0.8512	0.8459	0.8338	0.8128	0.7877	0.7533	0.7172	0.6876	0.6915	0.711	0.7325	0.7671	0.7971	0.8269	0.8616	0.8997
0.8298	1	0.9343	0.8238	0.8025	0.8193	0.834	0.7776	0.7007	0.6487	0.601	0.556	0.518	0.4827	0.4458	0.4194	0.4283	0.4524	0.4813	0.5236	0.5646	0.6003	0.6446	0.6962
0.7364	0.9343	1	0.9065	0.8726	0.8517	0.8036	0.7031	0.6113	0.5546	0.5048	0.4584	0.42	0.3894	0.3522	0.3274	0.3368	0.3583	0.3891	0.4295	0.473	0.5064	0.5507	0.6033
0.5682	0.8238	0.9065	1	0.9201	0.8219	0.6885	0.5443	0.4475	0.4008	0.3672	0.3357	0.3071	0.2816	0.2442	0.2176	0.2199	0.2341	0.2595	0.2948	0.3341	0.3619	0.3993	0.4461
0.5293	0.8025	0.8726	0.9201	1	0.8793	0.7054	0.5121	0.3928	0.3423	0.3135	0.2867	0.2617	0.2399	0.2071	0.1853	0.1868	0.1996	0.2261	0.2621	0.3031	0.3293	0.3642	0.4099
0.591	0.8193	0.8517	0.8219	0.8793	1	0.8131	0.6007	0.4472	0.3782	0.3325	0.2961	0.2661	0.243	0.2192	0.2063	0.2167	0.2375	0.2668	0.3072	0.3492	0.3778	0.4155	0.4636
0.7409	0.834	0.8036	0.6885	0.7054	0.8131	1	0.8088	0.6705	0.5719	0.4916	0.4311	0.3859	0.3494	0.3192	0.3017	0.3161	0.3423	0.3744	0.4232	0.4707	0.5074	0.5516	0.6016
0.8371	0.7776	0.7031	0.5443	0.5121	0.6007	0.8088	1	0.8887	0.8023	0.6959	0.6159	0.5534	0.4989	0.4563	0.4265	0.4377	0.4611	0.4879	0.5366	0.5817	0.621	0.6653	0.7108
0.8512	0.7007	0.6113	0.4475	0.3928	0.4472	0.6705	0.8887	1	0.9297	0.8309	0.741	0.6679	0.6014	0.5481	0.5046	0.5094	0.5299	0.552	0.5938	0.6304	0.6662	0.7062	0.7459
0.8459	0.6487	0.5546	0.4008	0.3423	0.3782	0.5719	0.8023	0.9297	1	0.9133	0.8358	0.7564	0.6803	0.6167	0.5646	0.5629	0.5817	0.6	0.6328	0.6597	0.6906	0.7249	0.7592
0.8338	0.601	0.5048	0.3672	0.3135	0.3325	0.4916	0.6959	0.8309	0.9133	1	0.9359	0.8636	0.7729	0.6933	0.6319	0.6238	0.6364	0.648	0.6694	0.6849	0.7083	0.7357	0.763
0.8128	0.556	0.4584	0.3357	0.2867	0.2961	0.4311	0.6159	0.741	0.8358	0.9359	1	0.9419	0.8603	0.7703	0.6983	0.6797	0.6831	0.6887	0.702	0.7101	0.7274	0.7471	0.7656
0.7877	0.518	0.42	0.3071	0.2617	0.2661	0.3859	0.5534	0.6679	0.7564	0.8636	0.9419	1	0.9352	0.8568	0.7769	0.7472	0.7392	0.7371	0.7415	0.742	0.7516	0.7615	0.7694
0.7533	0.4827	0.3894	0.2816	0.2399	0.243	0.3494	0.4989	0.6014	0.6803	0.7729	0.8603	0.9352	1	0.9322	0.8558	0.814	0.7939	0.7811	0.7735	0.7633	0.7623	0.7619	0.7599
0.7172	0.4458	3.52E-01	0.2442	0.2071	0.2192	0.3192	0.4563	0.5481	0.6167	0.6933	0.7703	0.8568	0.9322	1	0.9318	0.8912	0.8623	0.84	0.8195	0.7964	0.7824	0.7688	0.7534
0.6876	0.4194	0.3274	0.2176	0.1853	0.2063	0.3017	0.4265	0.5046	0.5646	0.6319	0.6983	0.7769	0.8558	0.9318	1	0.9606	0.9317	0.9025	0.8697	0.8331	0.8068	0.7811	0.7538
0.6915	0.4283	0.3368	0.2199	0.1868	0.2167	0.3161	0.4377	0.5094	0.5629	0.6238	0.6797	0.7472	0.814	0.8912	0.9606	1	0.9746	0.9479	0.9102	0.8679	0.8369	0.8071	0.7765
0.711	0.4524	0.3583	0.2341	0.1996	0.2375	0.3423	0.4611	0.5299	0.5817	0.6364	0.6831	0.7392	0.7939	0.8623	0.9317	0.9746	1	0.9779	0.9444	0.9044	0.8745	0.845	0.815
0.7325	0.4813	0.3891	0.2595	0.2261	0.2668	0.3744	0.4879	0.552	0.6	0.648	0.6887	0.7371	0.7811	0.84	0.9025	0.9479	0.9779	1	0.9721	0.9409	0.9146	0.8866	0.8566
0.7671	0.5236	0.4295	0.2948	0.2621	0.3072	0.4232	0.5366	0.5938	0.6328	0.6694	0.702	0.7415	0.7735	0.8195	0.8697	0.9102	0.9444	0.9721	1	0.9781	0.9598	0.9354	0.9065
0.7971	0.5646	0.473	0.3341	0.3031	0.3492	0.4707	0.5817	0.6304	0.6597	0.6849	0.7101	0.742	0.7633	0.7964	0.8331	0.8679	0.9044	0.9409	0.9781	1	0.9869	0.9693	0.9441
0.8269	0.6003	0.5064	0.3619	0.3293	0.3778	0.5074	0.621	0.6662	0.6906	0.7083	0.7274	0.7516	0.7623	0.7824	0.8068	0.8369	0.8745	0.9146	0.9598	0.9869	1	0.9876	0.9691
0.8616	0.6446	0.5507	0.3993	0.3642	0.4155	0.5516	0.6653	0.7062	0.7249	0.7357	0.7471	0.7615	0.7619	0.7688	0.7811	0.8071	0.845	0.8866	0.9354	0.9693	0.9876	1	0.9873
0.8997	0.6962	0.6033	0.4461	0.4099	0.4636	0.6016	0.7108	0.7459	0.7592	0.763	0.7656	0.7694	0.7599	0.7534	0.7538	0.7765	0.815	0.8566	0.9065	0.9441	0.9691	0.9873	1];
